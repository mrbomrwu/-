digraph G {
    node [shape=box, style=filled, fillcolor="#f9f9f9"];
    
    start [label="Start", shape=circle];
    init_cost [label="Initialize total_cost = 0\nInitialize total_defective_rate = 1"];
    comp_iter [label="For each component\n- Calculate purchase price\n- Check if inspected\n  - Adjust defect rate\n  - Add inspection cost"];
    semi_iter [label="For each semi-product\n- Calculate assembly cost\n- Check if inspected\n  - Adjust defect rate\n  - Add inspection cost"];
    final_product [label="Calculate final product cost\n- Check if inspected\n  - Add inspection cost"];
    exchange_loss [label="Calculate exchange loss based on defect rate"];
    dismantling [label="Add dismantling fees if applicable"];
    return_cost [label="Return total_cost and total_defective_rate"];
    end [label="End", shape=circle];
    
    start -> init_cost;
    init_cost -> comp_iter;
    comp_iter -> semi_iter;
    semi_iter -> final_product;
    final_product -> exchange_loss;
    exchange_loss -> dismantling;
    dismantling -> return_cost;
    return_cost -> end;
}
